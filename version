#!/bin/bash

# bash script to generate:
#   - lime/version.h
#   - clime/version.h
#   - version for cmake & meson

VERSION=2.0.0.4
IFS='.' read -r MAJOR MINOR PATCH EARLYRELEASE <<< "$VERSION"

VERSION_STR=""

if [[ $EARLYRELEASE -eq 0 ]]; then
  VERSION_STR="$MAJOR.$MINOR.$PATCH"
else
  VERSION_STR="$MAJOR.$MINOR.$PATCH.$EARLYRELEASE"
fi

cat <<EOF > include/clime/version.h
/*
 * WARNING: This file is auto-generated by the 'version' script.
 * Any changes made manually will be lost the next time the code is generated.
 *
 * Please modify the source templates or generation logic instead.
 */

#ifndef CLIME_VERSION_H
#define CLIME_VERSION_H

#define VERSION_MAJOR $MAJOR
#define VERSION_MINOR $MINOR
#define VERSION_PATCH $PATCH
#define VERSION_EARLYRELEASE $EARLYRELEASE
#define VERSION_STR "$VERSION_STR"

#endif // CLIME_VERSION_H
EOF

cat <<EOF > include/lime/version.h
/*
 * WARNING: This file is auto-generated by the 'version' script.
 * Any changes made manually will be lost the next time the code is generated.
 *
 * Please modify the source templates or generation logic instead.
 */

#ifndef LIME_VERSION_H
#define LIME_VERSION_H

#define VERSION_MAJOR $MAJOR
#define VERSION_MINOR $MINOR
#define VERSION_PATCH $PATCH
#define VERSION_EARLYRELEASE $EARLYRELEASE
#define VERSION_STR "$VERSION_STR"

#endif // CLIME_VERSION_H
EOF

echo $VERSION_STR
